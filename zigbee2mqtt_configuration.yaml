# Configuration Zigbee2MQTT pour SLZB-MR1-MEZZA
# Date: 2025-12-18
# Coordinateur: SLZB-MR1-MEZZA (192.168.0.166:6638)
# Broker MQTT: Mosquitto (localhost:1883)

# Chemin des données
data_path: /config/zigbee2mqtt

# Intégration Home Assistant (découverte automatique des entités)
homeassistant: true

# Mode appairage (désactivé par défaut pour la sécurité)
# À activer temporairement lors de l'appairage des appareils
permit_join: false

# Configuration MQTT
mqtt:
  base_topic: zigbee2mqtt
  server: mqtt://localhost:1883
  user: homeassistant
  password: !secret mqtt_password
  # Options avancées MQTT
  keepalive: 60
  reject_unauthorized: true
  version: 4

# Configuration du coordinateur SLZB-MR1-MEZZA (Silicon Labs EFR32)
serial:
  port: tcp://192.168.0.166:6638
  adapter: ezsp
  # Options pour EZSP
  disable_led: false
  # Baudrate non nécessaire pour connexion TCP

# Paramètres avancés du réseau Zigbee
advanced:
  # Niveau de log (info en production, debug pour troubleshooting)
  log_level: info
  log_output:
    - console

  # Génération automatique des paramètres réseau au premier démarrage
  pan_id: GENERATE
  network_key: GENERATE
  channel: 11  # Canal Zigbee (évite interférences WiFi canal 1, 6, 11)

  # Intégration Home Assistant
  homeassistant_discovery_topic: homeassistant
  homeassistant_status_topic: homeassistant/status

  # Affichage de la dernière activité des appareils
  last_seen: ISO_8601
  elapsed: false

  # Cache des états
  cache_state: true
  cache_state_persistent: true
  cache_state_send_on_startup: true

  # Puissance de transmission (20 dBm = maximum pour SLZB-MR1-MEZZA)
  transmit_power: 20

  # Options de routage mesh
  adapter_concurrent: null
  adapter_delay: 0

  # Comportement réseau
  report: false
  homeassistant_legacy_entity_attributes: false
  legacy_api: false
  legacy_availability_payload: false

# Options par défaut pour tous les périphériques
device_options:
  legacy: false  # Désactiver le mode legacy pour de meilleures performances
  retain: true  # Conserver les messages MQTT après redémarrage

# Interface Web Zigbee2MQTT
# Note: Port 8100 (le port 8099 est utilisé par HA Vibecode Agent - l'agent MCP)
frontend:
  port: 8100
  host: 0.0.0.0
  auth_token: !secret zigbee2mqtt_auth_token  # Optionnel mais recommandé

# Fonctionnalités expérimentales
experimental:
  new_api: true

# Configuration de disponibilité des appareils
availability:
  active:
    # Timeout pour appareils actifs (routeurs) en minutes
    timeout: 10
  passive:
    # Timeout pour appareils passifs (capteurs sur batterie) en minutes
    timeout: 1500

# Groupes d'appareils (à remplir après appairage)
groups: {}

# Appareils (géré automatiquement par Zigbee2MQTT)
# Ne pas éditer manuellement - utiliser l'interface Web
devices: {}
