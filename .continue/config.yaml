name: Domotique Ollama CPU
version: 1.0.0
schema: v1

# =========================================
# AUTOCOMPL√âTION RAPIDE (LOCAL)
# =========================================
autocomplete:
  providers:
    - provider: ollama
      model: llama3.2:3b
      systemMessage: |
        R√©ponds en fran√ßais.
        Compl√©tion rapide, courte et technique.
        Code concis, commentaires en fran√ßais si utile.

# =========================================
# MOD√àLES
# =========================================
models:
  # ‚ö° Mod√®le rapide (CPU-friendly)
  - name: Local Fast
    provider: ollama
    model: llama3.2:3b
    temperature: 0.3
    systemMessage: |
      R√©ponds UNIQUEMENT en fran√ßais.
      R√©ponses courtes et techniques.
      Indique clairement si une action MCP est n√©cessaire.

  # üí° Brainstorm l√©ger
  - name: Local Brainstorm
    provider: ollama
    model: gemma2:2b
    temperature: 0.4
    systemMessage: |
      R√©ponds UNIQUEMENT en fran√ßais.
      G√©n√®re des id√©es, alternatives et options.
      Format : listes courtes et actionnables.

  # üß† Orchestrateur domotique principal
  - name: Local Orchestrator
    provider: ollama
    model: mistral:7b-instruct
    temperature: 0.2
    systemMessage: |
      Tu r√©ponds UNIQUEMENT en fran√ßais.
      Tu es architecte domotique Home Assistant + Docker + r√©seau.

      Tu structures TOUJOURS tes r√©ponses ainsi :
      1) Architecture propos√©e
      2) Fichiers complets (docker-compose, YAML Home Assistant si demand√©)
      3) Explications br√®ves par bloc

      Contraintes :
      - YAML strictement valide (espaces, pas de tabulation)
      - docker-compose version >= 3.7
      - S√©parer r√©seau frontend / backend
      - R√©ponses concises, pas de blabla

  # üëÅ Vision (cloud, usage ponctuel)
  - name: Vision
    provider: google
    model: gemini-2.0-flash
    apiKey: ${GOOGLE_API_KEY}
    systemMessage: |
      Analyse des images uniquement.
      R√©ponds en fran√ßais.
      Va droit au but.

# =========================================
# AGENTS
# =========================================
agents:
  # üè†üîß Agent domotique principal
  - name: infra-domotique
    model: Local Orchestrator
    description: >
      Agent expert Home Assistant, Docker, MQTT, Zigbee2MQTT, ESPHome
      et conception d'un homelab domotique complet.
    instructions: |
      Tu es un architecte d'infrastructure domotique complet.

      Contexte :
      - Home Assistant en conteneur Docker
      - Linux, docker-compose
      - Services : MQTT, Zigbee2MQTT, ESPHome, InfluxDB, Grafana

      T√¢ches :
      - Concevoir et expliquer l'architecture globale
      - Proposer des docker-compose complets et coh√©rents
      - G√©n√©rer du YAML Home Assistant valide (int√©grations, automations)
      - Analyser et am√©liorer des stacks existantes

      Style :
      - Commencer par "Architecture propos√©e"
      - Puis fournir les fichiers complets
      - Puis expliquer bri√®vement chaque bloc

      Contraintes :
      - YAML strictement valide
      - docker-compose >= 3.7
      - S√©parer frontend / backend
      - Indiquer si red√©marrage n√©cessaire

  # ‚ö° Agent rapide
  - name: speed
    model: Local Fast
    goal: >
      Compl√©tion rapide, corrections courtes,
      snippets et r√©ponses efficaces.

  # üí° Brainstorm
  - name: brainstorm
    model: Local Brainstorm
    goal: >
      G√©n√©rer des id√©es, options et alternatives
      pour architectures ou automations.

  # üëÅ Vision
  - name: vision
    model: Vision
    goal: >
      Analyser des images (screenshots Home Assistant,
      sch√©mas r√©seau, photos de c√¢blage).

# =========================================
# MCP HOME ASSISTANT
# =========================================
mcpServers:
  - name: home-assistant
    command: npx
    args:
      - -y
      - "@coolver/home-assistant-mcp@latest"
    env:
      HA_AGENT_URL=http://192.168.0.166:8099
      HA_AGENT_KEY=jZT5-o3QZOXj00id5Z8_QOU1topknUozOWIL6QL-pl4
